-- ============================================================================
-- Township-level Subnational Breakdowns from Site Locations (Pure SQL)
-- Generated: 2026-02-01T15:04:40.361Z
-- ============================================================================
-- This SQL maps site locations to townships using bounding box matching
-- and populates subnational_breakdowns at the TOWNSHIP level.
--
-- How it works:
-- 1. Creates a temp table with township bounding boxes
-- 2. Matches site coordinates to township bounding boxes
-- 3. For overlapping boxes, selects the smallest (most specific) match
-- 4. Calculates equal percentage distribution per activity
-- 5. Inserts township-level breakdowns
-- ============================================================================

-- ============================================================================
-- STEP 1: Create township bounding box lookup table
-- ============================================================================

DROP TABLE IF EXISTS tmp_township_bounds;
CREATE TEMP TABLE tmp_township_bounds (
  ts_name TEXT,
  ts_pcode TEXT,
  st_name TEXT,
  st_pcode TEXT,
  min_lng DECIMAL(12,8),
  max_lng DECIMAL(12,8),
  min_lat DECIMAL(12,8),
  max_lat DECIMAL(12,8),
  centroid_lng DECIMAL(12,8),
  centroid_lat DECIMAL(12,8),
  area DECIMAL(20,10)
);

INSERT INTO tmp_township_bounds VALUES
('Hinthada', 'MMR017008', 'Ayeyarwady', 'MMR017', 95.21312544, 95.58215543, 17.40343684, 17.83465549, 95.39764044, 17.61904616, 0.1591326121),
('Ingapu', 'MMR017013', 'Ayeyarwady', 'MMR017', 94.87885515, 95.48750980, 17.64660479, 18.03473750, 95.18318248, 17.84067114, 0.2362387798),
('Kyangin', 'MMR017012', 'Ayeyarwady', 'MMR017', 94.82337251, 95.27232362, 18.14736042, 18.51084977, 95.04784806, 18.32910509, 0.1631889473),
('Lemyethna', 'MMR017010', 'Ayeyarwady', 'MMR017', 94.77982975, 95.26103574, 17.43813511, 17.76838981, 95.02043275, 17.60326246, 0.1589205376),
('Myanaung', 'MMR017011', 'Ayeyarwady', 'MMR017', 94.82173787, 95.46133497, 17.89996672, 18.32442033, 95.14153642, 18.11219352, 0.2714792992),
('Zalun', 'MMR017009', 'Ayeyarwady', 'MMR017', 95.41717353, 95.73613800, 17.34829996, 17.62454452, 95.57665577, 17.48642224, 0.0881121981),
('Labutta', 'MMR017016', 'Ayeyarwady', 'MMR017', 94.57289472, 95.09924087, 15.75678883, 16.37175442, 94.83606779, 16.06427163, 0.3236847758),
('Mawlamyinegyun', 'MMR017018', 'Ayeyarwady', 'MMR017', 95.04223651, 95.52450696, 16.03577525, 16.59227975, 95.28337174, 16.31402750, 0.2683856771),
('Danubyu', 'MMR017022', 'Ayeyarwady', 'MMR017', 95.36630006, 95.70975995, 17.07145635, 17.41218984, 95.53803001, 17.24182310, 0.1170282886),
('Maubin', 'MMR017019', 'Ayeyarwady', 'MMR017', 95.41107529, 95.88028884, 16.50749980, 16.88391971, 95.64568207, 16.69570975, 0.1766213237),
('Nyaungdon', 'MMR017021', 'Ayeyarwady', 'MMR017', 95.55273750, 95.84867292, 16.87009632, 17.20242211, 95.70070521, 17.03625921, 0.0983469696),
('Pantanaw', 'MMR017020', 'Ayeyarwady', 'MMR017', 95.20158236, 95.60695174, 16.79862674, 17.22767245, 95.40426705, 17.01314960, 0.1739219964),
('Einme', 'MMR017015', 'Ayeyarwady', 'MMR017', 94.94620469, 95.22220671, 16.57705178, 16.95548743, 95.08420570, 16.76626960, 0.1044490047),
('Myaungmya', 'MMR017014', 'Ayeyarwady', 'MMR017', 94.72773093, 95.05261245, 16.33190413, 16.74763384, 94.89017169, 16.53976899, 0.1350629000),
('Wakema', 'MMR017017', 'Ayeyarwady', 'MMR017', 95.03998638, 95.46465945, 16.33915396, 16.81957038, 95.25232292, 16.57936217, 0.2040199102),
('Kangyidaunt', 'MMR017002', 'Ayeyarwady', 'MMR017', 94.73759715, 95.03163833, 16.58643255, 16.97052907, 94.88461774, 16.77848081, 0.1129401929),
('Yegyi', 'MMR017006', 'Ayeyarwady', 'MMR017', 94.73216598, 95.18092582, 17.13144904, 17.57430939, 94.95654590, 17.35287922, 0.1987379410),
('Bogale', 'MMR017024', 'Ayeyarwady', 'MMR017', 95.11119054, 95.63871130, 15.79974241, 16.47132980, 95.37495092, 16.13553610, 0.3542762861),
('Dedaye', 'MMR017026', 'Ayeyarwady', 'MMR017', 95.70334397, 96.07974521, 16.12388882, 16.46118745, 95.89154459, 16.29253813, 0.1269596201),
('Kyaiklat', 'MMR017025', 'Ayeyarwady', 'MMR017', 95.41023534, 95.83541535, 16.39121664, 16.64598220, 95.62282534, 16.51859942, 0.1083212233),
('Pyapon', 'MMR017023', 'Ayeyarwady', 'MMR017', 95.29960066, 95.74074621, 15.71210064, 16.41786970, 95.52017343, 16.06498517, 0.3113468758),
('Bago', 'MMR007001', 'Bago (East)', 'MMR007', 96.04318392, 96.61505470, 17.04797603, 17.98671169, 96.32911931, 17.51734386, 0.5368354879),
('Daik-U', 'MMR007007', 'Bago (East)', 'MMR007', 96.32207500, 96.84720732, 17.59029215, 17.94174017, 96.58464116, 17.76601616, 0.1845567122),
('Kawa', 'MMR007003', 'Bago (East)', 'MMR007', 96.43763101, 96.82662591, 16.82924129, 17.16945471, 96.63212846, 16.99934800, 0.1323412872),
('Kyauktaga', 'MMR007006', 'Bago (East)', 'MMR007', 95.90624179, 96.74143560, 17.90009123, 18.49652307, 96.32383869, 18.19830715, 0.4981361777),
('Htantabin', 'MMR007014', 'Bago (East)', 'MMR007', 96.49534930, 96.65263376, 18.55825587, 18.89540617, 96.57399153, 18.72683102, 0.0530285004),
('Kyaukkyi', 'MMR007011', 'Bago (East)', 'MMR007', 96.59012035, 97.12453226, 18.12815446, 18.64995272, 96.85732631, 18.38905359, 0.2788552071),
('Oktwin', 'MMR007013', 'Bago (East)', 'MMR007', 95.83749629, 96.50382976, 18.58139056, 18.91422080, 96.17066302, 18.74780568, 0.2217759300),
('Phyu', 'MMR007012', 'Bago (East)', 'MMR007', 95.83749629, 96.67499343, 18.24754399, 18.81517863, 96.25624486, 18.53136131, 0.4753923873),
('Taungoo', 'MMR007009', 'Bago (East)', 'MMR007', 95.83500050, 96.67455644, 18.88452660, 19.15490508, 96.25477847, 19.01971584, 0.2269978530),
('Yedashe', 'MMR007010', 'Bago (East)', 'MMR007', 95.79487423, 96.49250209, 19.06191360, 19.47385921, 96.14368816, 19.26788641, 0.2873847393),
('Padaung', 'MMR008003', 'Bago (West)', 'MMR008', 94.69719485, 95.21526821, 18.35951275, 18.98090909, 94.95623153, 18.67021092, 0.3219288876),
('Kyaunggon', 'MMR017007', 'Ayeyarwady', 'MMR017', 94.97419310, 95.31830593, 16.89345890, 17.20538802, 95.14624951, 17.04942346, 0.1073388146),
('Kyonpyaw', 'MMR017005', 'Ayeyarwady', 'MMR017', 95.15323146, 95.40667923, 17.15241846, 17.48293666, 95.27995534, 17.31767756, 0.0837691008),
('Ngapudaw', 'MMR017004', 'Ayeyarwady', 'MMR017', 94.23790496, 94.67617431, 15.83468688, 16.73420587, 94.45703964, 16.28444638, 0.3942315991),
('Pathein', 'MMR017001', 'Ayeyarwady', 'MMR017', 94.36263454, 94.80569941, 16.62737486, 17.47530644, 94.58416697, 17.05134065, 0.3756886987),
('Thabaung', 'MMR017003', 'Ayeyarwady', 'MMR017', 94.56626013, 95.05134385, 16.92567558, 17.39084312, 94.80880199, 17.15825935, 0.2256452027),
('Nyaunglebin', 'MMR007005', 'Bago (East)', 'MMR007', 96.59822142, 96.86733133, 17.72251055, 18.08076524, 96.73277637, 17.90163790, 0.0964098888),
('Shwegyin', 'MMR007008', 'Bago (East)', 'MMR007', 96.74053063, 97.21888755, 17.49989108, 18.21001260, 96.97970909, 17.85495184, 0.3396915503),
('Thanatpin', 'MMR007002', 'Bago (East)', 'MMR007', 96.48772535, 96.87070274, 17.13992119, 17.37654021, 96.67921404, 17.25823070, 0.0906197374),
('Paukkhaung', 'MMR008002', 'Bago (West)', 'MMR008', 95.35667583, 95.85826653, 18.74121748, 19.18376743, 95.60747118, 18.96249246, 0.2219789403),
('Paungde', 'MMR008004', 'Bago (West)', 'MMR008', 95.37209036, 95.81798314, 18.43356812, 18.85334615, 95.59503675, 18.64345714, 0.1871759916),
('Waw', 'MMR007004', 'Bago (East)', 'MMR007', 96.57956345, 96.89548989, 17.35408184, 17.73811244, 96.73752667, 17.54609714, 0.1213254183),
('Hakha', 'MMR004002', 'Chin', 'MMR004', 93.50833102, 94.00787320, 22.00573885, 22.81409939, 93.75810211, 22.40991912, 0.4038101899),
('Thantlang', 'MMR004003', 'Chin', 'MMR004', 93.12540228, 93.53593859, 22.08590204, 23.07273903, 93.33067043, 22.57932053, 0.4051324223),
('Matupi', 'MMR004007', 'Chin', 'MMR004', 93.02875339, 94.00975378, 21.24955320, 22.23018950, 93.51925359, 21.73987135, 0.9620045990),
('Paletwa', 'MMR004009', 'Chin', 'MMR004', 92.60637167, 93.64342371, 20.70747510, 22.15390069, 93.12489769, 21.43068790, 1.5000186125),
('Kanpetlet', 'MMR004008', 'Chin', 'MMR004', 93.52197189, 94.12000071, 20.65004623, 21.29955976, 93.82098630, 20.97480299, 0.3884278100),
('Mindat', 'MMR004006', 'Chin', 'MMR004', 93.50807064, 94.11772797, 21.08302859, 21.79144399, 93.81289930, 21.43723629, 0.4318906411),
('Bhamo', 'MMR001010', 'Kachin', 'MMR001', 96.77790287, 97.39491090, 23.71619193, 24.71005639, 97.08640689, 24.21312416, 0.6132223497),
('Mansi', 'MMR001013', 'Kachin', 'MMR001', 96.97464528, 97.73324805, 23.63324538, 24.18618452, 97.35394667, 23.90971495, 0.4194611698),
('Momauk', 'MMR001012', 'Kachin', 'MMR001', 97.17211658, 97.73324805, 24.17585282, 24.90497679, 97.45268232, 24.54041481, 0.4091344073),
('Shwegu', 'MMR001011', 'Kachin', 'MMR001', 96.55215998, 97.07813585, 23.99991868, 24.76161247, 96.81514791, 24.38076557, 0.4006325626),
('Hpakant', 'MMR001009', 'Kachin', 'MMR001', 95.96322435, 96.90877920, 25.24798325, 26.11879628, 96.43600178, 25.68338976, 0.8234014784),
('Mogaung', 'MMR001008', 'Kachin', 'MMR001', 96.55358611, 97.19731281, 24.96906156, 25.73279421, 96.87544946, 25.35092788, 0.4916350952),
('Mohnyin', 'MMR001007', 'Kachin', 'MMR001', 95.80617229, 96.79247071, 24.47976824, 25.43045618, 96.29932150, 24.95511221, 0.9376620095),
('Chipwi', 'MMR001005', 'Kachin', 'MMR001', 97.94310809, 98.74823706, 25.54796813, 26.50981998, 98.34567258, 26.02889405, 0.7744147976),
('Injangyang', 'MMR001003', 'Kachin', 'MMR001', 97.50188067, 98.28920210, 25.58560331, 26.79581524, 97.89554139, 26.19070927, 0.9528257982),
('Myitkyina', 'MMR001001', 'Kachin', 'MMR001', 96.68572695, 97.53590079, 24.57017601, 26.18766572, 97.11081387, 25.37892087, 1.3751474343),
('Pyay', 'MMR008001', 'Bago (West)', 'MMR008', 95.14967672, 95.47813838, 18.74783909, 19.08863937, 95.31390755, 18.91823923, 0.1119398248),
('Tanai', 'MMR001004', 'Kachin', 'MMR001', 96.00783924, 97.26550092, 25.71909106, 27.09272996, 96.63667008, 26.40591051, 1.7275730071),
('Shwedaung', 'MMR008006', 'Bago (West)', 'MMR008', 95.10738335, 95.33947526, 18.35658095, 18.77177571, 95.22342930, 18.56417833, 0.0963633423),
('Machanbaw', 'MMR001016', 'Kachin', 'MMR001', 97.37817492, 98.16840154, 26.73742398, 27.75688352, 97.77328823, 27.24715375, 0.8056040547),
('Nawngmun', 'MMR001017', 'Kachin', 'MMR001', 97.35001080, 98.37309256, 27.31037129, 28.53648126, 97.86155168, 27.92342628, 1.2544107430),
('Puta-O', 'MMR001014', 'Kachin', 'MMR001', 96.88955568, 97.74829696, 26.71037110, 27.98113035, 97.31892632, 27.34575072, 1.0912534346),
('Sumprabum', 'MMR001015', 'Kachin', 'MMR001', 97.20792586, 98.27216157, 25.97299303, 26.80023718, 97.74004371, 26.38661511, 0.8803827656),
('Chanmyathazi', 'MMR010004', 'Mandalay', 'MMR010', 96.05465691, 96.13803143, 21.91025947, 21.95019723, 96.09634417, 21.93022835, 0.0033297913),
('Thegon', 'MMR008005', 'Bago (West)', 'MMR008', 95.28325023, 95.56614048, 18.43159775, 18.77323551, 95.42469535, 18.60241663, 0.0966459908),
('Gyobingauk', 'MMR008014', 'Bago (West)', 'MMR008', 95.45595495, 96.04318452, 18.09903737, 18.44889095, 95.74956974, 18.27396416, 0.2054443673),
('Letpadan', 'MMR008008', 'Bago (West)', 'MMR008', 95.43204144, 96.20022397, 17.60781086, 18.12404977, 95.81613271, 17.86593032, 0.3965657153),
('Loikaw', 'MMR002001', 'Kayah', 'MMR002', 97.12803848, 97.52211202, 19.24273062, 19.99244863, 97.32507525, 19.61758962, 0.2954440302),
('Shadaw', 'MMR002004', 'Kayah', 'MMR002', 97.39720061, 97.86325691, 19.16412533, 19.87966343, 97.63022876, 19.52189438, 0.3334810422),
('Hlaingbwe', 'MMR003002', 'Kayin', 'MMR003', 97.60324147, 98.30473292, 16.67928101, 17.83187942, 97.95398720, 17.25558022, 0.8085379380),
('Hpa-An', 'MMR003001', 'Kayin', 'MMR003', 97.40693818, 98.01096097, 16.57341576, 17.70524656, 97.70894957, 17.13933116, 0.6836515902),
('Thandaunggyi', 'MMR003004', 'Kayin', 'MMR003', 96.39160505, 97.03640975, 18.64551277, 19.50906082, 96.71400740, 19.07728680, 0.5568198424),
('Hpapun', 'MMR003003', 'Kayin', 'MMR003', 96.93297048, 97.76122008, 17.32812056, 18.81033247, 97.34709528, 18.06922652, 1.2276414331),
('Kawkareik', 'MMR003006', 'Kayin', 'MMR003', 97.82614062, 98.42957466, 16.19730471, 16.85694293, 98.12785764, 16.52712382, 0.3980481540),
('Kyainseikgyi', 'MMR003007', 'Kayin', 'MMR003', 97.81311436, 98.56262482, 15.22062590, 16.42877633, 98.18786959, 15.82470112, 0.9055213770),
('Myawaddy', 'MMR003005', 'Kayin', 'MMR003', 98.16342334, 98.92170008, 16.04209155, 17.09125366, 98.54256171, 16.56667261, 0.7955552265),
('Gangaw', 'MMR009023', 'Magway', 'MMR009', 93.98169130, 94.41668736, 21.79441763, 22.77105557, 94.19918933, 22.28273660, 0.4248336554),
('Saw', 'MMR009025', 'Magway', 'MMR009', 94.00357851, 94.33174605, 20.83469252, 21.57313560, 94.16766228, 21.20391406, 0.2423330534),
('Minhla', 'MMR008009', 'Bago (West)', 'MMR008', 95.56241450, 95.98284471, 17.86504963, 18.10309073, 95.77262960, 17.98407018, 0.1000796709),
('Natmauk', 'MMR009006', 'Magway', 'MMR009', 95.11164898, 95.74883833, 20.27897406, 20.77202017, 95.43024366, 20.52549712, 0.3141637290),
('Monyo', 'MMR008013', 'Bago (West)', 'MMR008', 95.26369601, 95.56486164, 17.84286089, 18.35834293, 95.41427883, 18.10060191, 0.1552454742),
('Nattalin', 'MMR008012', 'Bago (West)', 'MMR008', 95.33832037, 95.96279044, 18.24158762, 18.79276368, 95.65055541, 18.51717565, 0.3441929582),
('Okpho', 'MMR008010', 'Bago (West)', 'MMR008', 95.55950866, 96.12766523, 18.03499443, 18.33184688, 95.84358695, 18.18342066, 0.1686586700),
('Thayarwady', 'MMR008007', 'Bago (West)', 'MMR008', 95.62456999, 96.08399595, 17.47799234, 17.91592949, 95.85428297, 17.69696091, 0.2011996970),
('Taungdwingyi', 'MMR009004', 'Magway', 'MMR009', 95.30466043, 95.79648648, 19.62855978, 20.12096433, 95.55057346, 19.87476205, 0.2421773773),
('Zigon', 'MMR008011', 'Bago (West)', 'MMR008', 95.50216066, 95.80089674, 18.28342194, 18.43608247, 95.65152870, 18.35975220, 0.0456052071),
('Falam', 'MMR004001', 'Chin', 'MMR004', 93.33986649, 93.99213299, 22.80866245, 23.36875963, 93.66599974, 23.08871104, 0.3653326228),
('Tedim', 'MMR004004', 'Chin', 'MMR004', 93.38860780, 94.00970948, 23.17987440, 23.58169104, 93.69915864, 23.38078272, 0.2495689844),
('Aungmyaythazan', 'MMR010001', 'Mandalay', 'MMR010', 96.05954049, 96.12867932, 21.98135310, 22.02614837, 96.09410991, 22.00375074, 0.0030970932),
('Tonzang', 'MMR004005', 'Chin', 'MMR004', 93.34081957, 94.14216340, 23.51320847, 24.10505579, 93.74149148, 23.80913213, 0.4742731979),
('Tsawlaw', 'MMR001006', 'Kachin', 'MMR001', 98.14331612, 98.74823706, 26.02749047, 26.85056424, 98.44577659, 26.43902736, 0.4978945688),
('Waingmaw', 'MMR001002', 'Kachin', 'MMR001', 97.25558662, 98.16821836, 24.74309052, 25.72548586, 97.71190249, 25.23428819, 0.8965651649),
('Khaunglanhpu', 'MMR001018', 'Kachin', 'MMR001', 97.92737839, 98.73342645, 26.71845598, 27.66660661, 98.33040242, 27.19253130, 0.7642549797),
('Bawlake', 'MMR002005', 'Kayah', 'MMR002', 97.21968612, 97.84088446, 18.83412372, 19.34625768, 97.53028529, 19.09019070, 0.3181367605),
('Hpasawng', 'MMR002006', 'Kayah', 'MMR002', 96.95320134, 97.43609057, 18.59892932, 19.08120077, 97.19464596, 18.84006504, 0.2328836883),
('Mese', 'MMR002007', 'Kayah', 'MMR002', 97.32056378, 97.76891251, 18.49161148, 18.97688703, 97.54473814, 18.73424925, 0.2175726735),
('Chanayethazan', 'MMR010002', 'Mandalay', 'MMR010', 96.05619093, 96.13159917, 21.96686608, 21.98441218, 96.09389505, 21.97563913, 0.0013231204),
('Demoso', 'MMR002002', 'Kayah', 'MMR002', 96.87607731, 97.41045563, 19.24273062, 19.71504024, 97.14326647, 19.47888543, 0.2523920189),
('Hpruso', 'MMR002003', 'Kayah', 'MMR002', 96.83416597, 97.31231563, 19.01953683, 19.53072940, 97.07324080, 19.27513312, 0.2444265547),
('Tilin', 'MMR009024', 'Magway', 'MMR009', 93.98169130, 94.31675544, 21.49061982, 21.96709090, 94.14922337, 21.72885536, 0.1596483679),
('Chauk', 'MMR009003', 'Magway', 'MMR009', 94.70739820, 95.02241706, 20.52942256, 20.94051643, 94.86490763, 20.73496950, 0.1295023232),
('Mahaaungmyay', 'MMR010003', 'Mandalay', 'MMR010', 96.04959395, 96.13159917, 21.94803873, 21.97149065, 96.09059656, 21.95976469, 0.0019231796),
('Patheingyi', 'MMR010007', 'Mandalay', 'MMR010', 96.01274283, 96.36551082, 21.81044512, 22.16743839, 96.18912682, 21.98894175, 0.1259357976),
('Magway', 'MMR009001', 'Magway', 'MMR009', 94.89681708, 95.41414316, 19.80981274, 20.35916240, 95.15548012, 20.08448757, 0.2841929066),
('Myothit', 'MMR009005', 'Magway', 'MMR009', 95.18309567, 95.78207262, 20.01456559, 20.34881011, 95.48258414, 20.18168785, 0.2002047658),
('Yenangyaung', 'MMR009002', 'Magway', 'MMR009', 94.77995525, 95.16879111, 20.29356365, 20.62531211, 94.97437318, 20.45943788, 0.1289956968),
('Minbu', 'MMR009007', 'Magway', 'MMR009', 94.46983211, 95.00744315, 19.89402508, 20.29205706, 94.73863763, 20.09304107, 0.2139863867),
('Yamethin', 'MMR010023', 'Mandalay', 'MMR010', 95.72379880, 96.50475890, 20.19306887, 20.59383574, 96.11427885, 20.39345230, 0.3129829357),
('Ngape', 'MMR009009', 'Magway', 'MMR009', 94.21240416, 94.64334252, 19.72203850, 20.19760563, 94.42787334, 19.95982207, 0.2049401180),
('Kyaikmaraw', 'MMR011002', 'Mon', 'MMR011', 97.66039536, 98.12510824, 16.12099632, 16.56121254, 97.89275180, 16.34110443, 0.2045741468),
('Mawlamyine', 'MMR011001', 'Mon', 'MMR011', 97.62945008, 97.69986570, 16.36096795, 16.61124611, 97.66465789, 16.48610703, 0.0176234939),
('Mudon', 'MMR011005', 'Mon', 'MMR011', 97.58361174, 97.86687416, 15.96451207, 16.39272738, 97.72524295, 16.17861972, 0.1212973057),
('Thanbyuzayat', 'MMR011004', 'Mon', 'MMR011', 97.55864178, 97.86780876, 15.61104433, 16.09359204, 97.71322527, 15.85231819, 0.1491878191),
('Ye', 'MMR011006', 'Mon', 'MMR011', 97.72648455, 98.20818751, 14.88767881, 15.67868114, 97.96733603, 15.28317998, 0.3810281667),
('Pwintbyu', 'MMR009008', 'Magway', 'MMR009', 94.37973391, 94.91966186, 20.13475642, 20.48034206, 94.64969788, 20.30754924, 0.1865913431),
('Bilin', 'MMR011010', 'Mon', 'MMR011', 96.92997496, 97.49953598, 16.98780047, 17.70524656, 97.21475547, 17.34652352, 0.4086293296),
('Salin', 'MMR009010', 'Magway', 'MMR009', 94.24621363, 94.79966085, 20.45919854, 20.98413255, 94.52293724, 20.72166555, 0.2905232711),
('Sidoktaya', 'MMR009011', 'Magway', 'MMR009', 93.86341557, 94.41337800, 20.10567436, 20.96011758, 94.13839679, 20.53289597, 0.4699116667),
('Myaing', 'MMR009020', 'Magway', 'MMR009', 94.54426277, 95.14789990, 21.38336911, 21.85852648, 94.84608133, 21.62094779, 0.2868226345),
('Tatkon', 'MMR018003', 'Nay Pyi Taw', 'MMR018', 95.73695565, 96.50475890, 20.01353496, 20.33103767, 96.12085727, 20.17228632, 0.2437796152),
('Zay Yar Thi Ri', 'MMR018001', 'Nay Pyi Taw', 'MMR018', 96.23170044, 96.45429437, 19.75970148, 20.01549648, 96.34299740, 19.88759898, 0.0569384126),
('Pakokku', 'MMR009018', 'Magway', 'MMR009', 94.67324463, 95.22789568, 20.89909292, 21.48137324, 94.95057016, 21.19023308, 0.3229623873),
('Ann', 'MMR012014', 'Rakhine', 'MMR012', 93.69473606, 94.38266195, 19.27919133, 20.55625289, 94.03869900, 19.91772211, 0.8785237104),
('Kyaukpyu', 'MMR012011', 'Rakhine', 'MMR012', 93.48756986, 93.87605121, 19.07016861, 19.56859414, 93.68181053, 19.31938137, 0.1936290205),
('Munaung', 'MMR012012', 'Rakhine', 'MMR012', 93.47911904, 93.74367527, 18.66831508, 18.89885277, 93.61139716, 18.78358393, 0.0609901829),
('Ramree', 'MMR012013', 'Rakhine', 'MMR012', 93.66343857, 94.07155579, 18.84691642, 19.37704231, 93.86749718, 19.11197937, 0.2163535075),
('Buthidaung', 'MMR012010', 'Rakhine', 'MMR012', 92.36090088, 92.75063693, 20.58294076, 21.38248853, 92.55576890, 20.98271464, 0.3116125883),
('Maungdaw', 'MMR012009', 'Rakhine', 'MMR012', 92.17280204, 92.62724257, 20.44767990, 21.47963284, 92.40002231, 20.96365637, 0.4689612462),
('Kyauktaw', 'MMR012004', 'Rakhine', 'MMR012', 92.73285963, 93.16312502, 20.59101257, 21.21142135, 92.94799232, 20.90121696, 0.2669404283),
('Minbya', 'MMR012005', 'Rakhine', 'MMR012', 93.13324914, 93.84732194, 20.08898698, 20.92395593, 93.49028554, 20.50647146, 0.5962286123),
('Mrauk-U', 'MMR012003', 'Rakhine', 'MMR012', 93.03489848, 93.40536000, 20.34945005, 20.84355345, 93.22012924, 20.59650175, 0.1830462968),
('Myebon', 'MMR012006', 'Rakhine', 'MMR012', 93.20260594, 93.80436906, 19.68311273, 20.24982648, 93.50348750, 19.96646960, 0.3410274295),
('Pauktaw', 'MMR012007', 'Rakhine', 'MMR012', 92.97198840, 93.22273079, 19.78873177, 20.39229235, 93.09735959, 20.09051206, 0.1513382207),
('Ponnagyun', 'MMR012002', 'Rakhine', 'MMR012', 92.70358399, 93.07768533, 20.24672844, 21.01131371, 92.89063466, 20.62902108, 0.2860323768),
('Rathedaung', 'MMR012008', 'Rakhine', 'MMR012', 92.59408503, 92.86699369, 20.23913237, 20.75139550, 92.73053936, 20.49526393, 0.1398010472),
('Pauk', 'MMR009021', 'Magway', 'MMR009', 94.28739056, 94.73315540, 21.20690390, 21.83572577, 94.51027298, 21.52131484, 0.2803066743),
('Seikphyu', 'MMR009022', 'Magway', 'MMR009', 94.30841052, 94.81095033, 20.83708194, 21.26654327, 94.55968043, 21.05181260, 0.2158214177),
('Yesagyo', 'MMR009019', 'Magway', 'MMR009', 95.00319389, 95.34201667, 21.38196513, 21.83450319, 95.17260528, 21.60823416, 0.1533302054),
('Aunglan', 'MMR009016', 'Magway', 'MMR009', 95.14475857, 95.82708185, 18.93071022, 19.48165364, 95.48592021, 19.20618193, 0.3759215243),
('Kamma', 'MMR009015', 'Magway', 'MMR009', 94.67026318, 95.17465880, 18.83204466, 19.19274045, 94.92246099, 19.01239256, 0.1819333741),
('Mindon', 'MMR009014', 'Magway', 'MMR009', 94.34973059, 94.92084457, 19.05217075, 19.58424243, 94.63528758, 19.31820659, 0.3038735689),
('Minhla', 'MMR009013', 'Magway', 'MMR009', 94.32156234, 95.14573661, 19.56039431, 19.99963392, 94.73364948, 19.78001411, 0.3620099897),
('Sinbaungwe', 'MMR009017', 'Magway', 'MMR009', 94.96773923, 95.78328681, 19.46395309, 19.84796601, 95.37551302, 19.65595955, 0.3131808077),
('Thayet', 'MMR009012', 'Magway', 'MMR009', 94.88464460, 95.17465880, 19.17788373, 19.58020928, 95.02965170, 19.37904650, 0.1166801235),
('Kyaukse', 'MMR010013', 'Mandalay', 'MMR010', 96.00282098, 96.89598274, 21.45433673, 22.01808347, 96.44940186, 21.73621010, 0.5035170231),
('Myittha', 'MMR010015', 'Mandalay', 'MMR010', 95.97264677, 96.37744185, 21.13442821, 21.54752114, 96.17504431, 21.34097468, 0.1672179880),
('Sintgaing', 'MMR010014', 'Mandalay', 'MMR010', 95.99488567, 96.26546690, 21.65572397, 21.82977802, 96.13017628, 21.74275100, 0.0470957588),
('Tada-U', 'MMR010016', 'Mandalay', 'MMR010', 95.78393539, 96.01357068, 21.47568306, 21.91164857, 95.89875304, 21.69366581, 0.1001130668),
('Amarapura', 'MMR010006', 'Mandalay', 'MMR010', 95.98739436, 96.20141631, 21.82831297, 21.95344165, 96.09440534, 21.89087731, 0.0267802848),
('Pyigyitagon', 'MMR010005', 'Mandalay', 'MMR010', 96.07770049, 96.13803143, 21.87208831, 21.92574917, 96.10786596, 21.89891874, 0.0032374100),
('Budalin', 'MMR005013', 'Sagaing', 'MMR005', 94.95731964, 95.26989128, 22.24393272, 22.63359915, 95.11360546, 22.43876593, 0.1217986745),
('Mahlaing', 'MMR010029', 'Mandalay', 'MMR010', 95.46240296, 95.81209738, 20.90969644, 21.28981027, 95.63725017, 21.09975335, 0.1329236855),
('Mongla', 'MMR016005', 'Shan (East)', 'MMR016', 99.67666854, 100.17551295, 21.27078286, 21.74139633, 99.92609074, 21.50608959, 0.2347628992),
('Mongping', 'MMR016007', 'Shan (East)', 'MMR016', 98.48844399, 99.33383124, 20.57986054, 21.63490275, 98.91113761, 21.10738165, 0.8919192285),
('Mongyang', 'MMR016003', 'Shan (East)', 'MMR016', 99.04949988, 99.97482978, 21.70931720, 22.16268907, 99.51216483, 21.93600313, 0.4195185413),
('Monghsat', 'MMR016006', 'Shan (East)', 'MMR016', 98.99274835, 99.66728163, 20.10991292, 20.99528996, 99.33001499, 20.55260144, 0.5972162735),
('Mongton', 'MMR016008', 'Shan (East)', 'MMR016', 98.22698636, 99.24559958, 19.67151415, 20.79371358, 98.73629297, 20.23261386, 1.1430871807),
('Monghpyak', 'MMR016010', 'Shan (East)', 'MMR016', 99.52397474, 100.14872167, 20.76605797, 21.15321165, 99.83634821, 20.95963481, 0.2418730765),
('Mongyawng', 'MMR016011', 'Shan (East)', 'MMR016', 100.07386213, 101.16174643, 20.96349098, 21.77656729, 100.61780428, 21.37002913, 0.8845329500),
('Tachileik', 'MMR016009', 'Shan (East)', 'MMR016', 99.61980427, 100.64787374, 20.33637631, 21.02301948, 100.13383901, 20.67969789, 0.7059168809),
('Hopang', 'MMR015021', 'Shan (North)', 'MMR015', 98.43409513, 98.94505999, 22.95440380, 23.47853553, 98.68957756, 23.21646967, 0.2678128990),
('Mongmao', 'MMR015008', 'Shan (North)', 'MMR015', 98.52685917, 99.21056589, 22.71111083, 23.18197124, 98.86871253, 22.94654103, 0.3219304291),
('Meiktila', 'MMR010028', 'Mandalay', 'MMR010', 95.51244916, 95.99958556, 20.69849091, 20.99075495, 95.75601736, 20.84462293, 0.1423724561),
('Thazi', 'MMR010030', 'Mandalay', 'MMR010', 95.97269201, 96.57415186, 20.51033499, 21.05675280, 96.27342194, 20.78354389, 0.3286483700),
('Wundwin', 'MMR010031', 'Mandalay', 'MMR010', 95.79647932, 96.21879160, 20.99039415, 21.40584605, 96.00763546, 21.19812010, 0.1754504393),
('Tangyan', 'MMR015004', 'Shan (North)', 'MMR015', 98.04708415, 98.76844267, 21.85684114, 22.95548887, 98.40776341, 22.40616500, 0.7925189038),
('Matman', 'MMR015024', 'Shan (North)', 'MMR015', 98.54271694, 99.12083489, 21.48475077, 22.25857083, 98.83177592, 21.87166080, 0.4473592671),
('Myingyan', 'MMR010017', 'Mandalay', 'MMR010', 95.24781749, 95.63078416, 21.33791645, 21.74380836, 95.43930082, 21.54086241, 0.1554430728),
('Natogyi', 'MMR010019', 'Mandalay', 'MMR010', 95.46170094, 95.97877312, 21.28253013, 21.61527772, 95.72023703, 21.44890393, 0.1720545257),
('Tanintharyi', 'MMR006008', 'Tanintharyi', 'MMR006', 98.75485290, 99.66531838, 11.31645813, 13.45330874, 99.21008564, 12.38488344, 1.9455287073),
('Ngazun', 'MMR010021', 'Mandalay', 'MMR010', 95.41597486, 95.81086263, 21.60792080, 21.92167507, 95.61341875, 21.76479794, 0.1238977223),
('Taungtha', 'MMR010018', 'Mandalay', 'MMR010', 95.10426227, 95.63169328, 21.01015406, 21.40042362, 95.36797778, 21.20528884, 0.2058402710),
('Kyaukpadaung', 'MMR010020', 'Mandalay', 'MMR010', 94.99876719, 95.54459944, 20.54267506, 21.09855057, 95.27168331, 20.82061282, 0.3034147774),
('Nyaung-U', 'MMR010022', 'Mandalay', 'MMR010', 94.83128356, 95.22075693, 20.86466353, 21.31369711, 95.02602025, 21.08918032, 0.1748866208),
('Madaya', 'MMR010009', 'Mandalay', 'MMR010', 95.99135351, 96.36551082, 22.01908298, 22.40263959, 96.17843216, 22.21086128, 0.1435105063),
('Mogoke', 'MMR010011', 'Mandalay', 'MMR010', 96.22371028, 96.71624632, 22.76314355, 23.05321693, 96.46997830, 22.90818024, 0.1428715978),
('Pyinoolwin', 'MMR010008', 'Mandalay', 'MMR010', 96.25736992, 96.75647520, 21.66858739, 22.36821151, 96.50692256, 22.01839945, 0.3491860916),
('Botahtaung', 'MMR013017', 'Yangon', 'MMR013', 96.16395939, 96.18523471, 16.76702462, 16.78070381, 96.17459705, 16.77386421, 0.0002910291),
('Dagon Myothit (East)', 'MMR013020', 'Yangon', 'MMR013', 96.18000293, 96.29711723, 16.87132390, 17.01761818, 96.23856008, 16.94447104, 0.0171331524),
('Singu', 'MMR010010', 'Mandalay', 'MMR010', 95.90337091, 96.32931747, 22.29638211, 22.77588256, 96.11634419, 22.53613234, 0.2042415653),
('Thabeikkyin', 'MMR010012', 'Mandalay', 'MMR010', 95.96527290, 96.39255802, 22.74845799, 23.68380907, 96.17891546, 23.21613353, 0.3996615991),
('Pyawbwe', 'MMR010024', 'Mandalay', 'MMR010', 95.59852402, 96.34337754, 20.39606659, 20.76375761, 95.97095078, 20.57991210, 0.2738759467),
('Chaungzon', 'MMR011003', 'Mon', 'MMR011', 97.43864716, 97.61173547, 16.19053895, 16.50160937, 97.52519132, 16.34607416, 0.0538426555),
('Kyaikto', 'MMR011009', 'Mon', 'MMR011', 96.87629730, 97.21622789, 17.23574800, 17.60359546, 97.04626259, 17.41967173, 0.1250426044),
('Paung', 'MMR011008', 'Mon', 'MMR011', 97.23129911, 97.64626588, 16.50752256, 16.80596526, 97.43878249, 16.65674391, 0.1238437996),
('Thaton', 'MMR011007', 'Mon', 'MMR011', 97.16764470, 97.49589734, 16.75393799, 17.20713603, 97.33177102, 16.98053701, 0.1487634556),
('Det Khi Na Thi Ri', 'MMR018004', 'Nay Pyi Taw', 'MMR018', 95.99732138, 96.17486460, 19.65324265, 19.76802470, 96.08609299, 19.71063367, 0.0203787744),
('Lewe', 'MMR018007', 'Nay Pyi Taw', 'MMR018', 95.71270039, 96.48787388, 19.45962514, 19.94058812, 96.10028713, 19.70010663, 0.3728297559),
('Pyinmana', 'MMR018006', 'Nay Pyi Taw', 'MMR018', 96.15548176, 96.66796682, 19.42746873, 19.85004366, 96.41172429, 19.63875620, 0.2165633349),
('Za Bu Thi Ri', 'MMR018002', 'Nay Pyi Taw', 'MMR018', 96.04107221, 96.18464442, 19.70497109, 19.76815802, 96.11285832, 19.73656455, 0.0090718865),
('Oke Ta Ra Thi Ri', 'MMR018008', 'Nay Pyi Taw', 'MMR018', 95.78139856, 96.14633326, 19.76504918, 20.04905208, 95.96386591, 19.90705063, 0.1036425144),
('Poke Ba Thi Ri', 'MMR018005', 'Nay Pyi Taw', 'MMR018', 96.14117040, 96.23512517, 19.75176445, 20.02930863, 96.18814779, 19.89053654, 0.0260765974),
('Sittwe', 'MMR012001', 'Rakhine', 'MMR012', 92.76181109, 92.91961409, 20.11275908, 20.29794225, 92.84071259, 20.20535067, 0.0292224599),
('Gwa', 'MMR012017', 'Rakhine', 'MMR012', 94.44478771, 94.82252838, 17.33846070, 18.13664925, 94.63365804, 17.73755498, 0.3015082795),
('Thandwe', 'MMR012015', 'Rakhine', 'MMR012', 94.23765948, 94.87731223, 17.98186681, 18.74342161, 94.55748585, 18.36264421, 0.4871306194),
('Toungup', 'MMR012016', 'Rakhine', 'MMR012', 94.02076149, 94.76114066, 18.62608269, 19.53833996, 94.39095107, 19.08221133, 0.6754162802),
('Hkamti', 'MMR005033', 'Sagaing', 'MMR005', 95.03758362, 96.21633950, 25.31597242, 26.48919465, 95.62696156, 25.90258354, 1.3829426031),
('Homalin', 'MMR005034', 'Sagaing', 'MMR005', 94.58825945, 96.07047267, 24.33415420, 25.53506201, 95.32936606, 24.93460811, 1.7800014219),
('Kale', 'MMR005027', 'Sagaing', 'MMR005', 93.94618824, 94.27882866, 22.58300520, 23.65149451, 94.11250845, 23.11724986, 0.3554227322),
('Kalewa', 'MMR005028', 'Sagaing', 'MMR005', 94.19558519, 94.94739714, 22.97885243, 23.58504294, 94.57149117, 23.28194768, 0.4557412738),
('Mingin', 'MMR005029', 'Sagaing', 'MMR005', 94.19558519, 94.93303932, 22.26338325, 23.31199417, 94.56431226, 22.78768871, 0.7733024545),
('Kanbalu', 'MMR005007', 'Sagaing', 'MMR005', 95.37484479, 95.97248375, 22.84708695, 23.72833711, 95.67366427, 23.28771203, 0.5266694255),
('Kyunhla', 'MMR005008', 'Sagaing', 'MMR005', 94.86317207, 95.62253714, 23.24620537, 23.83437105, 95.24285460, 23.54028821, 0.4466324654),
('Banmauk', 'MMR005023', 'Sagaing', 'MMR005', 95.28475212, 96.02693368, 24.15789134, 24.95998888, 95.65584290, 24.55894011, 0.5953020007),
('Indaw', 'MMR005021', 'Sagaing', 'MMR005', 95.95027926, 96.31463133, 23.90373050, 24.66317542, 96.13245530, 24.28345296, 0.2767053338),
('Katha', 'MMR005020', 'Sagaing', 'MMR005', 96.16482580, 96.66306124, 23.72876915, 24.50732130, 96.41394352, 24.11804522, 0.3879022716),
('Tigyaing', 'MMR005022', 'Sagaing', 'MMR005', 95.97010223, 96.53071637, 23.51180207, 24.05618471, 96.25040930, 23.78399339, 0.3051886038),
('Kawlin', 'MMR005024', 'Sagaing', 'MMR005', 95.29327389, 95.99784658, 23.49006970, 23.90592371, 95.64556023, 23.69799671, 0.2929993792),
('Pinlebu', 'MMR005026', 'Sagaing', 'MMR005', 95.01876891, 95.73882278, 23.70167027, 24.37118950, 95.37879585, 24.03642988, 0.4820899071),
('Wuntho', 'MMR005025', 'Sagaing', 'MMR005', 95.56262304, 96.00180960, 23.81473053, 24.20010519, 95.78221632, 24.00741786, 0.1692513693),
('Mawlaik', 'MMR005031', 'Sagaing', 'MMR005', 94.18756646, 95.01276876, 23.31121332, 23.99777598, 94.60016761, 23.65449465, 0.5665530839),
('Paungbyin', 'MMR005032', 'Sagaing', 'MMR005', 94.49795698, 95.36028807, 23.76059464, 24.58405106, 94.92912253, 24.17232285, 0.7100920681),
('Ayadaw', 'MMR005014', 'Sagaing', 'MMR005', 95.25642844, 95.64452824, 22.11597008, 22.48902761, 95.45047834, 22.30249885, 0.1447835584),
('Chaung-U', 'MMR005015', 'Sagaing', 'MMR005', 95.14243548, 95.36992155, 21.79143200, 22.03677769, 95.25617851, 21.91410484, 0.0558127276),
('Dawbon', 'MMR013014', 'Yangon', 'MMR013', 96.18568187, 96.20238626, 16.77391350, 16.81023229, 96.19403406, 16.79207290, 0.0006066833),
('Monywa', 'MMR005012', 'Sagaing', 'MMR005', 95.04920016, 95.36992155, 21.93529674, 22.29812749, 95.20956085, 22.11671212, 0.1163675825),
('Lahe', 'MMR005036', 'Sagaing', 'MMR005', 95.01167843, 95.90216652, 25.75742532, 26.70129435, 95.45692247, 26.22935984, 0.8405041294),
('Layshi', 'MMR005035', 'Sagaing', 'MMR005', 94.57769997, 95.23103923, 24.87438463, 25.74063381, 94.90436960, 25.30750922, 0.5659546020),
('Nanyun', 'MMR005037', 'Sagaing', 'MMR005', 95.43274161, 97.06658536, 26.46364228, 27.37204736, 96.24966348, 26.91784482, 1.4841919669),
('Lanmadaw', 'MMR013035', 'Yangon', 'MMR013', 96.13422108, 96.16425425, 16.76702462, 16.78684139, 96.14923766, 16.77693301, 0.0005951606),
('Myaung', 'MMR005003', 'Sagaing', 'MMR005', 95.17709889, 95.47357645, 21.57594450, 21.86284121, 95.32533767, 21.71939286, 0.0850584379),
('Latha', 'MMR013036', 'Yangon', 'MMR013', 96.14797232, 96.15325743, 16.77180250, 16.78156365, 96.15061487, 16.77668307, 0.0000515888),
('Mayangone', 'MMR013042', 'Yangon', 'MMR013', 96.09527322, 96.17849077, 16.82505226, 16.89370918, 96.13688200, 16.85938072, 0.0057134610),
('Pabedan', 'MMR013034', 'Yangon', 'MMR013', 96.15293980, 96.15909778, 16.77062699, 16.78141371, 96.15601879, 16.77602035, 0.0000664245),
('Myinmu', 'MMR005002', 'Sagaing', 'MMR005', 95.35134677, 95.64452824, 21.85468145, 22.16173903, 95.49793751, 22.00821024, 0.0900235923),
('Sagaing', 'MMR005001', 'Sagaing', 'MMR005', 95.62106256, 96.01875864, 21.86800413, 22.20428561, 95.81991060, 22.03614487, 0.1337378290),
('Khin-U', 'MMR005005', 'Sagaing', 'MMR005', 95.42634535, 95.96673469, 22.67157804, 22.87852668, 95.69654002, 22.77505236, 0.1118328397),
('Shwebo', 'MMR005004', 'Sagaing', 'MMR005', 95.42376848, 95.97385620, 22.45390096, 22.69995309, 95.69881234, 22.57692703, 0.1353502520),
('Tabayin', 'MMR005010', 'Sagaing', 'MMR005', 94.82208619, 95.54395660, 22.44684621, 22.81417848, 95.18302139, 22.63051234, 0.2651662916),
('Taze', 'MMR005011', 'Sagaing', 'MMR005', 94.87034333, 95.48010250, 22.85815516, 23.26151333, 95.17522291, 23.05983425, 0.2459513393),
('Wetlet', 'MMR005006', 'Sagaing', 'MMR005', 95.52670017, 96.00975901, 22.19316649, 22.50083539, 95.76822959, 22.34700094, 0.1486221810),
('Ye-U', 'MMR005009', 'Sagaing', 'MMR005', 94.76708868, 95.48244064, 22.67157804, 23.03107596, 95.12476466, 22.85132700, 0.2571675441),
('Tamu', 'MMR005030', 'Sagaing', 'MMR005', 94.13209557, 94.61050362, 23.64510870, 24.72718628, 94.37129960, 24.18614749, 0.5176746167),
('Kani', 'MMR005017', 'Sagaing', 'MMR005', 94.26762263, 95.03952050, 22.13663099, 22.82981202, 94.65357157, 22.48322151, 0.5350649638),
('Pale', 'MMR005019', 'Sagaing', 'MMR005', 94.41168779, 94.91020569, 21.79311328, 22.23928789, 94.66094674, 22.01620059, 0.2224260270),
('Salingyi', 'MMR005018', 'Sagaing', 'MMR005', 94.87272058, 95.16362935, 21.83395360, 22.14822218, 95.01817496, 21.99108789, 0.0914234877),
('Yinmarbin', 'MMR005016', 'Sagaing', 'MMR005', 94.61550721, 95.08736530, 21.99134375, 22.31850807, 94.85143625, 22.15492591, 0.1543751312),
('Kengtung', 'MMR016001', 'Shan (East)', 'MMR016', 99.25584471, 100.17551295, 20.88769150, 21.59749189, 99.71567883, 21.24259170, 0.6527808728),
('Mongkhet', 'MMR016002', 'Shan (East)', 'MMR016', 98.91237006, 99.68823025, 21.50139290, 21.90432649, 99.30030015, 21.70285970, 0.3126201349),
('Pangwaun', 'MMR015007', 'Shan (North)', 'MMR015', 99.02535071, 99.55999666, 22.75285413, 23.09939226, 99.29267368, 22.92612320, 0.1852752040),
('Konkyan', 'MMR015023', 'Shan (North)', 'MMR015', 98.41416466, 98.89921093, 23.74979146, 24.11329381, 98.65668780, 23.93154263, 0.1763154539),
('Laukkaing', 'MMR015022', 'Shan (North)', 'MMR015', 98.55833499, 98.89085944, 23.47421755, 23.80899259, 98.72459722, 23.64160507, 0.1113208845),
('Hsipaw', 'MMR015014', 'Shan (North)', 'MMR015', 97.11085015, 98.02244986, 21.95717823, 22.82460514, 97.56665001, 22.39089168, 0.7907461237),
('Kyaukme', 'MMR015012', 'Shan (North)', 'MMR015', 96.39237204, 97.34590639, 22.20839533, 22.94396680, 96.86913922, 22.57618107, 0.7013926680),
('Namtu', 'MMR015015', 'Shan (North)', 'MMR015', 97.16139322, 97.65788072, 22.70926101, 23.30088550, 97.40963697, 23.00507326, 0.2937341643),
('Nawnghkio', 'MMR015013', 'Shan (North)', 'MMR015', 96.20652086, 96.95067412, 21.93839812, 22.79189640, 96.57859749, 22.36514726, 0.6351335259),
('Hseni', 'MMR015002', 'Shan (North)', 'MMR015', 97.68435813, 98.42270722, 23.11364852, 23.39991767, 98.05353267, 23.25678310, 0.2113665713),
('Kunlong', 'MMR015020', 'Shan (North)', 'MMR015', 98.41989820, 98.81761382, 23.18155537, 23.69405556, 98.61875601, 23.43780546, 0.2038293297),
('Lashio', 'MMR015001', 'Shan (North)', 'MMR015', 97.54385711, 98.55653582, 22.61536549, 23.23701801, 98.05019647, 22.92619175, 0.6295342757),
('Mongyai', 'MMR015003', 'Shan (North)', 'MMR015', 97.79960348, 98.32483809, 22.06408837, 22.83230475, 98.06222078, 22.44819656, 0.4034938308),
('Narphan', 'MMR015006', 'Shan (North)', 'MMR015', 98.92895412, 99.37993409, 22.33643071, 22.79320064, 99.15444410, 22.56481567, 0.2059940843),
('Pangsang (Panghkam)', 'MMR015005', 'Shan (North)', 'MMR015', 98.51838359, 99.26080303, 22.14793051, 22.88742370, 98.88959331, 22.51767711, 0.5490141211),
('Mabein', 'MMR015018', 'Shan (North)', 'MMR015', 96.18871477, 97.33759396, 23.24966221, 24.15771274, 96.76315437, 23.70368748, 1.0432403593),
('Mongmit', 'MMR015017', 'Shan (North)', 'MMR015', 96.18871477, 97.04164420, 22.89401103, 23.43257623, 96.61517948, 23.16329363, 0.4593581012),
('Kutkai', 'MMR015011', 'Shan (North)', 'MMR015', 97.60156274, 98.58789578, 23.21538310, 24.03753869, 98.09472926, 23.62646090, 0.8109192214),
('Muse', 'MMR015009', 'Shan (North)', 'MMR015', 97.74777853, 98.59431187, 23.67070135, 24.10621962, 98.17104520, 23.88846049, 0.3686807348),
('Namhkan', 'MMR015010', 'Shan (North)', 'MMR015', 97.34429701, 97.85878613, 23.45247782, 23.90217118, 97.60154157, 23.67732450, 0.2313623429),
('Manton', 'MMR015019', 'Shan (North)', 'MMR015', 96.96001369, 97.69416875, 23.11933352, 23.69687427, 97.32709122, 23.40810389, 0.4240044644),
('Namhsan', 'MMR015016', 'Shan (North)', 'MMR015', 96.80864878, 97.37715630, 22.71560764, 23.17520467, 97.09290254, 22.94540615, 0.2612843686),
('Pindaya', 'MMR014006', 'Shan (South)', 'MMR014', 96.56400339, 96.77309907, 20.78102668, 21.13365567, 96.66855123, 20.95734118, 0.0737331970),
('Ywangan', 'MMR014007', 'Shan (South)', 'MMR014', 96.21514645, 96.78483385, 20.83793746, 21.73454093, 96.49999015, 21.28623920, 0.5107836961),
('Langkho', 'MMR014018', 'Shan (South)', 'MMR014', 97.64431512, 98.28721394, 19.57480239, 20.59787760, 97.96576453, 20.08634000, 0.6577338437),
('Mawkmai', 'MMR014020', 'Shan (South)', 'MMR014', 97.38816088, 97.81976843, 19.67491311, 20.50598393, 97.60396465, 20.09044852, 0.3586964432),
('Mongnai', 'MMR014019', 'Shan (South)', 'MMR014', 97.64508186, 98.63128414, 20.42277282, 20.96813246, 98.13818300, 20.69545264, 0.5378349155),
('Mongpan', 'MMR014021', 'Shan (South)', 'MMR014', 98.03342214, 98.68589572, 20.01931935, 20.49352670, 98.35965893, 20.25642302, 0.3094077676),
('Kunhing', 'MMR014014', 'Shan (South)', 'MMR014', 98.23668797, 98.80549908, 20.91950978, 21.63144681, 98.52109353, 21.27547830, 0.4049576901),
('Kyethi', 'MMR014015', 'Shan (South)', 'MMR014', 97.67455040, 98.35282627, 21.21483327, 22.11730899, 98.01368834, 21.66607113, 0.6121274997),
('Laihka', 'MMR014012', 'Shan (South)', 'MMR014', 97.40158234, 98.13390951, 20.99795809, 21.55160597, 97.76774592, 21.27478203, 0.4054513899),
('Loilen', 'MMR014011', 'Shan (South)', 'MMR014', 97.40158234, 97.64281797, 20.45394669, 21.25134409, 97.52220016, 20.85264539, 0.1923606667),
('Monghsu', 'MMR014017', 'Shan (South)', 'MMR014', 98.14645929, 98.62584442, 21.52105076, 22.10928491, 98.38615185, 21.81516784, 0.2819907059),
('Mongkaing', 'MMR014016', 'Shan (South)', 'MMR014', 97.13344555, 97.88074985, 21.41969867, 22.06542309, 97.50709770, 21.74256088, 0.4825526420),
('Nansang', 'MMR014013', 'Shan (South)', 'MMR014', 97.47973873, 98.32486947, 20.44234865, 21.22175764, 97.90230410, 20.83205314, 0.6587024982),
('Hopong', 'MMR014003', 'Shan (South)', 'MMR014', 97.03791381, 97.44079021, 20.53960816, 21.44341797, 97.23935201, 20.99151306, 0.3641236416),
('Hsihseng', 'MMR014004', 'Shan (South)', 'MMR014', 97.10971924, 97.47004703, 19.89085184, 20.53995670, 97.28988314, 20.21540427, 0.2338905179),
('Pinlaung', 'MMR014009', 'Shan (South)', 'MMR014', 96.36355264, 97.01435477, 19.74482558, 20.49842950, 96.68895371, 20.12162754, 0.4904470423),
('Kalaw', 'MMR014005', 'Shan (South)', 'MMR014', 96.43993688, 96.89888515, 20.47988222, 21.04325974, 96.66941101, 20.76157098, 0.2585611340),
('Lawksawk', 'MMR014008', 'Shan (South)', 'MMR014', 96.61698891, 97.30097785, 21.00240886, 22.26823740, 96.95898338, 21.63532313, 0.8658127197),
('Nyaungshwe', 'MMR014002', 'Shan (South)', 'MMR014', 96.76545125, 97.14738090, 19.97209898, 20.73146641, 96.95641608, 20.35178269, 0.2900249350),
('Pekon', 'MMR014010', 'Shan (South)', 'MMR014', 96.54765114, 97.14738090, 19.33269137, 19.97608768, 96.84751602, 19.65438952, 0.3858639107),
('Taunggyi', 'MMR014001', 'Shan (South)', 'MMR014', 96.81214806, 97.17967396, 20.16699099, 21.06382442, 96.99591101, 20.61540771, 0.3296095193),
('Dawei', 'MMR006001', 'Tanintharyi', 'MMR006', 98.17541927, 99.18851678, 13.29203929, 14.60345323, 98.68196802, 13.94774626, 1.3285901905),
('Launglon', 'MMR006002', 'Tanintharyi', 'MMR006', 98.08328184, 98.19113702, 13.53587751, 14.21925698, 98.13720943, 13.87756724, 0.0737060145),
('Thayetchaung', 'MMR006003', 'Tanintharyi', 'MMR006', 98.22030146, 98.65667998, 13.27964754, 14.00363299, 98.43849072, 13.64164026, 0.3159316974),
('Yebyu', 'MMR006004', 'Tanintharyi', 'MMR006', 97.79797663, 98.43916791, 14.17473355, 15.08063820, 98.11857227, 14.62768588, 0.5808581543),
('Bokpyin', 'MMR006010', 'Tanintharyi', 'MMR006', 98.08284515, 99.32484689, 10.57033018, 11.86541804, 98.70384602, 11.21787411, 1.6085013771),
('Kawthoung', 'MMR006009', 'Tanintharyi', 'MMR006', 98.46237725, 98.92517479, 9.97433879, 10.90782378, 98.69377602, 10.44108128, 0.4320145615),
('Kyunsu', 'MMR006006', 'Tanintharyi', 'MMR006', 97.94213896, 98.93268602, 11.43677150, 12.67031485, 98.43741249, 12.05354317, 1.2218827386),
('Myeik', 'MMR006005', 'Tanintharyi', 'MMR006', 98.59340590, 98.90749776, 12.22245625, 12.74074710, 98.75045183, 12.48160168, 0.1627909350),
('Palaw', 'MMR006007', 'Tanintharyi', 'MMR006', 98.53394615, 98.86925467, 12.70282728, 13.52865830, 98.70160041, 13.11574279, 0.2769081734),
('Dagon Myothit (North)', 'MMR013019', 'Yangon', 'MMR013', 96.16158790, 96.22501373, 16.84956590, 16.92298112, 96.19330082, 16.88627351, 0.0046564215),
('Dagon Myothit (Seikkan)', 'MMR013021', 'Yangon', 'MMR013', 96.23707644, 96.36832970, 16.80301135, 16.95332070, 96.30270307, 16.87816603, 0.0197285909),
('Dagon Myothit (South)', 'MMR013018', 'Yangon', 'MMR013', 96.20996293, 96.33590896, 16.80940978, 17.01761818, 96.27293594, 16.91351398, 0.0262230230),
('Mingalartaungnyunt', 'MMR013022', 'Yangon', 'MMR013', 96.15650108, 96.18650912, 16.77909386, 16.80857989, 96.17150510, 16.79383687, 0.0008848182),
('North Okkalapa', 'MMR013012', 'Yangon', 'MMR013', 96.15038300, 96.21386455, 16.87406927, 16.96222343, 96.18212377, 16.91814635, 0.0055961626),
('Pazundaung', 'MMR013016', 'Yangon', 'MMR013', 96.16747908, 96.18523471, 16.77519283, 16.78308495, 96.17635689, 16.77913889, 0.0001401296),
('South Okkalapa', 'MMR013011', 'Yangon', 'MMR013', 96.16428427, 96.20218887, 16.83381112, 16.86488411, 96.18323657, 16.84934762, 0.0011778093),
('Yankin', 'MMR013010', 'Yangon', 'MMR013', 96.15470325, 96.17870808, 16.82178275, 16.85251496, 96.16670567, 16.83714885, 0.0007377213),
('Tamwe', 'MMR013015', 'Yangon', 'MMR013', 96.16654629, 96.18771634, 16.79304724, 16.82397758, 96.17713132, 16.80851241, 0.0006547968),
('Mingaladon', 'MMR013002', 'Yangon', 'MMR013', 96.09551357, 96.17678553, 16.88937187, 17.06660009, 96.13614955, 16.97798598, 0.0144036857),
('Shwepyithar', 'MMR013007', 'Yangon', 'MMR013', 96.03235851, 96.10868320, 16.92943397, 17.02555596, 96.07052085, 16.97749496, 0.0073364810),
('Taikkyi', 'MMR013005', 'Yangon', 'MMR013', 95.61798874, 96.12810298, 17.16790935, 17.79147492, 95.87304586, 17.47969214, 0.3180896744),
('Thaketa', 'MMR013013', 'Yangon', 'MMR013', 96.19219739, 96.23222415, 16.77391350, 16.81781972, 96.21221077, 16.79586661, 0.0017574233),
('Seikgyikanaungto', 'MMR013031', 'Yangon', 'MMR013', 96.08158767, 96.12964920, 16.74864696, 16.78490624, 96.10561844, 16.76677660, 0.0017426765),
('Thingangyun', 'MMR013009', 'Yangon', 'MMR013', 96.17426840, 96.22024353, 16.80995374, 16.85173199, 96.19725597, 16.83084287, 0.0019207601),
('Thanlyin', 'MMR013023', 'Yangon', 'MMR013', 96.21708608, 96.43474031, 16.67266631, 16.97583055, 96.32591319, 16.82424843, 0.0659849794),
('Thongwa', 'MMR013025', 'Yangon', 'MMR013', 96.40076625, 96.78514963, 16.54446052, 16.87081052, 96.59295794, 16.70763552, 0.1254435161),
('Twantay', 'MMR013027', 'Yangon', 'MMR013', 95.82268321, 96.11110458, 16.55627137, 16.88946719, 95.96689389, 16.72286928, 0.0961007996),
('Hlaingtharya (East)', 'MMR013046', 'Yangon', 'MMR013', 96.03571787, 96.11267953, 16.83094324, 16.91263597, 96.07419870, 16.87178960, 0.0062872083),
('Hlaingtharya (West)', 'MMR013047', 'Yangon', 'MMR013', 96.00134473, 96.08087155, 16.86040693, 16.93828120, 96.04110814, 16.89934406, 0.0061930933),
('Hlegu', 'MMR013004', 'Yangon', 'MMR013', 96.02813151, 96.40416225, 16.94501437, 17.64102139, 96.21614688, 17.29301788, 0.2617200360),
('Hmawbi', 'MMR013003', 'Yangon', 'MMR013', 95.90418054, 96.16610574, 16.98263020, 17.23252631, 96.03514314, 17.10757825, 0.0654540896),
('Htantabin', 'MMR013006', 'Yangon', 'MMR013', 95.78320597, 96.06333754, 16.86608215, 17.23252631, 95.92327175, 17.04930423, 0.1026525784),
('Insein', 'MMR013001', 'Yangon', 'MMR013', 96.07177443, 96.13259773, 16.86219537, 16.94180548, 96.10218608, 16.90200043, 0.0048421499),
('Cocokyun', 'MMR013032', 'Yangon', 'MMR013', 93.35195104, 93.37067473, 14.04582802, 14.15229669, 93.36131289, 14.09906235, 0.0019934867),
('Ahlone', 'MMR013037', 'Yangon', 'MMR013', 96.12738216, 96.13547046, 16.77317845, 16.79793921, 96.13142631, 16.78555883, 0.0002002724),
('Dala', 'MMR013030', 'Yangon', 'MMR013', 96.05850114, 96.23375558, 16.60810743, 16.75657488, 96.14612836, 16.68234115, 0.0260195799),
('Kawhmu', 'MMR013028', 'Yangon', 'MMR013', 95.82319537, 96.27296841, 16.41825912, 16.66794792, 96.04808189, 16.54310352, 0.1123032875),
('Kayan', 'MMR013026', 'Yangon', 'MMR013', 96.39506025, 96.78514963, 16.77744427, 16.98051849, 96.59010494, 16.87898138, 0.0792170990),
('Kyauktada', 'MMR013033', 'Yangon', 'MMR013', 96.15804312, 96.16468646, 16.76918841, 16.77936725, 96.16136479, 16.77427783, 0.0000676216),
('Kungyangon', 'MMR013029', 'Yangon', 'MMR013', 95.88473924, 96.31110824, 16.31851039, 16.54772751, 96.09792374, 16.43311895, 0.0977310759),
('Kyauktan', 'MMR013024', 'Yangon', 'MMR013', 96.24284120, 96.66017380, 16.47730083, 16.72673555, 96.45150750, 16.60201819, 0.1040972409),
('Bahan', 'MMR013044', 'Yangon', 'MMR013', 96.14263916, 96.16987236, 16.79304724, 16.82918942, 96.15625576, 16.81111833, 0.0009842669),
('Dagon', 'MMR013043', 'Yangon', 'MMR013', 96.13143449, 96.15909778, 16.78106188, 16.80466366, 96.14526613, 16.79286277, 0.0006529028),
('Kyeemyindaing', 'MMR013038', 'Yangon', 'MMR013', 96.08557945, 96.11530656, 16.78155396, 16.83094324, 96.10044301, 16.80624860, 0.0014682004),
('Hlaing', 'MMR013040', 'Yangon', 'MMR013', 96.09912198, 96.13595566, 16.83099779, 16.85445984, 96.11753882, 16.84272881, 0.0008641934),
('Kamaryut', 'MMR013041', 'Yangon', 'MMR013', 96.11494280, 96.14647893, 16.80466366, 16.84157929, 96.13071086, 16.82312147, 0.0011641761),
('Sanchaung', 'MMR013039', 'Yangon', 'MMR013', 96.12624931, 96.14263916, 16.79672994, 16.81724349, 96.13444424, 16.80698672, 0.0003362139);

-- Create index for faster lookups
CREATE INDEX idx_township_bounds_coords ON tmp_township_bounds(min_lng, max_lng, min_lat, max_lat);

-- ============================================================================
-- STEP 2: Preview site locations and their township matches
-- ============================================================================
-- Uncomment to preview before making changes:
/*
WITH site_township_matches AS (
  SELECT
    al.activity_id,
    al.location_name,
    al.latitude,
    al.longitude,
    tb.ts_name,
    tb.ts_pcode,
    tb.st_name,
    tb.st_pcode,
    tb.area,
    -- Distance from centroid (for tie-breaking)
    SQRT(POWER(al.longitude - tb.centroid_lng, 2) + POWER(al.latitude - tb.centroid_lat, 2)) as dist_from_centroid,
    ROW_NUMBER() OVER (
      PARTITION BY al.id
      ORDER BY tb.area ASC, SQRT(POWER(al.longitude - tb.centroid_lng, 2) + POWER(al.latitude - tb.centroid_lat, 2)) ASC
    ) as match_rank
  FROM activity_locations al
  CROSS JOIN tmp_township_bounds tb
  WHERE al.location_type = 'site'
    AND al.latitude IS NOT NULL
    AND al.longitude IS NOT NULL
    AND al.longitude BETWEEN tb.min_lng AND tb.max_lng
    AND al.latitude BETWEEN tb.min_lat AND tb.max_lat
)
SELECT
  a.title_narrative,
  stm.location_name,
  stm.latitude,
  stm.longitude,
  stm.st_name || ' - ' || stm.ts_name as township,
  stm.ts_pcode
FROM site_township_matches stm
JOIN activities a ON a.id = stm.activity_id
WHERE stm.match_rank = 1
ORDER BY a.title_narrative, stm.ts_name;
*/

-- ============================================================================
-- STEP 3: Map sites to townships (best match = smallest bounding box)
-- ============================================================================

DROP TABLE IF EXISTS tmp_site_townships;
CREATE TEMP TABLE tmp_site_townships AS
WITH site_township_matches AS (
  SELECT
    al.activity_id,
    al.id as location_id,
    al.location_name,
    al.latitude,
    al.longitude,
    tb.ts_name,
    tb.ts_pcode,
    tb.st_name,
    tb.st_pcode,
    tb.area,
    -- Use smallest bounding box and closest to centroid for best match
    ROW_NUMBER() OVER (
      PARTITION BY al.id
      ORDER BY tb.area ASC,
               SQRT(POWER(al.longitude - tb.centroid_lng, 2) + POWER(al.latitude - tb.centroid_lat, 2)) ASC
    ) as match_rank
  FROM activity_locations al
  CROSS JOIN tmp_township_bounds tb
  WHERE al.location_type = 'site'
    AND al.latitude IS NOT NULL
    AND al.longitude IS NOT NULL
    AND al.longitude BETWEEN tb.min_lng AND tb.max_lng
    AND al.latitude BETWEEN tb.min_lat AND tb.max_lat
)
SELECT
  activity_id,
  location_id,
  location_name,
  latitude,
  longitude,
  ts_name,
  ts_pcode,
  st_name,
  st_pcode
FROM site_township_matches
WHERE match_rank = 1;

-- Show mapping results
SELECT 'Sites mapped to townships: ' || COUNT(*)::TEXT as info FROM tmp_site_townships;

-- Show unmapped sites (outside Myanmar or no match)
SELECT 'Unmapped sites: ' || COUNT(*)::TEXT as info
FROM activity_locations al
WHERE al.location_type = 'site'
  AND al.latitude IS NOT NULL
  AND al.longitude IS NOT NULL
  AND NOT EXISTS (
    SELECT 1 FROM tmp_site_townships st WHERE st.location_id = al.id
  );

-- ============================================================================
-- STEP 4: Calculate township distribution per activity
-- ============================================================================

DROP TABLE IF EXISTS tmp_activity_townships;
CREATE TEMP TABLE tmp_activity_townships AS
SELECT DISTINCT
  activity_id,
  ts_name,
  ts_pcode,
  st_name,
  st_pcode,
  st_name || ' - ' || ts_name as region_name
FROM tmp_site_townships;

-- Count townships per activity
DROP TABLE IF EXISTS tmp_township_counts;
CREATE TEMP TABLE tmp_township_counts AS
SELECT
  activity_id,
  COUNT(*) as township_count
FROM tmp_activity_townships
GROUP BY activity_id;

-- ============================================================================
-- STEP 5: Delete existing breakdowns for activities with site locations
-- ============================================================================

DELETE FROM subnational_breakdowns
WHERE activity_id IN (SELECT DISTINCT activity_id FROM tmp_activity_townships);

-- ============================================================================
-- STEP 6: Insert township-level breakdowns with equal distribution
-- ============================================================================

WITH ranked_townships AS (
  SELECT
    at.activity_id,
    at.region_name,
    at.ts_pcode,
    at.st_pcode,
    tc.township_count,
    ROW_NUMBER() OVER (PARTITION BY at.activity_id ORDER BY at.region_name) as rn
  FROM tmp_activity_townships at
  JOIN tmp_township_counts tc ON tc.activity_id = at.activity_id
),
breakdown_data AS (
  SELECT
    activity_id,
    region_name,
    ts_pcode,
    st_pcode,
    township_count,
    CASE
      WHEN rn = 1 THEN
        -- First township gets remainder to ensure sum = 100%
        ROUND(100.0 - (FLOOR(10000.0 / township_count) / 100.0 * (township_count - 1)), 2)
      ELSE
        ROUND(FLOOR(10000.0 / township_count) / 100.0, 2)
    END as percentage
  FROM ranked_townships
)
INSERT INTO subnational_breakdowns (
  activity_id,
  region_name,
  percentage,
  is_nationwide,
  allocation_level,
  st_pcode,
  ts_pcode,
  created_at,
  updated_at
)
SELECT
  activity_id,
  region_name,
  percentage,
  false,
  'township',
  st_pcode,
  ts_pcode,
  NOW(),
  NOW()
FROM breakdown_data;

-- ============================================================================
-- STEP 7: Verification
-- ============================================================================

-- Count by allocation level
SELECT
  'Breakdown counts by level:' as info;
SELECT
  COALESCE(allocation_level, 'region') as level,
  COUNT(*) as count
FROM subnational_breakdowns
GROUP BY allocation_level;

-- Verify all activities sum to 100%
SELECT
  'Activities with percentage totals:' as info;
SELECT
  a.title_narrative,
  sb.allocation_level,
  COUNT(*) as township_count,
  SUM(sb.percentage) as total_percentage
FROM subnational_breakdowns sb
JOIN activities a ON a.id = sb.activity_id
WHERE sb.activity_id IN (SELECT DISTINCT activity_id FROM tmp_activity_townships)
GROUP BY a.title_narrative, sb.allocation_level
ORDER BY a.title_narrative;

-- Show sample of new breakdowns
SELECT
  'Sample township breakdowns:' as info;
SELECT
  a.title_narrative,
  sb.region_name,
  sb.percentage,
  sb.ts_pcode
FROM subnational_breakdowns sb
JOIN activities a ON a.id = sb.activity_id
WHERE sb.allocation_level = 'township'
ORDER BY a.title_narrative, sb.region_name
LIMIT 30;

-- Cleanup temp tables
DROP TABLE IF EXISTS tmp_township_bounds;
DROP TABLE IF EXISTS tmp_site_townships;
DROP TABLE IF EXISTS tmp_activity_townships;
DROP TABLE IF EXISTS tmp_township_counts;
