@tailwind base;
@tailwind components;
@tailwind utilities;

/* ===== CSS Reset/Normalize for Cross-Browser Consistency ===== */

/* Universal box-sizing */
*, *::before, *::after {
  box-sizing: border-box;
}

/* Prevent font scaling in landscape on iOS */
html {
  -webkit-text-size-adjust: 100%;
  text-size-adjust: 100%;
}

/* Ensure images/media are responsive */
img, picture, video, canvas, svg {
  display: block;
  max-width: 100%;
}

/* Form elements inherit font */
button, input, select, textarea {
  font: inherit;
}

/* React DatePicker CSS - imported in components as needed */

/* Hide number input stepper controls */
input[type=number]::-webkit-outer-spin-button,
input[type=number]::-webkit-inner-spin-button {
  -webkit-appearance: none;
  margin: 0;
}

input[type=number] {
  -moz-appearance: textfield;
}

/* Debug: Test if CSS is loading */
.tailwind-test {
  background-color: #ff0000 !important;
  color: white !important;
  padding: 1rem !important;
  border-radius: 0.5rem !important;
}

/* Fix for search container clipping */
.search-container {
  position: relative;
  z-index: 50;
}

/* Fix focus ring clipping issues */
input:focus,
textarea:focus,
select:focus {
  position: relative;
  z-index: 10;
}

/* Fix for Leaflet map rendering and blur issues */
.leaflet-container {
  z-index: 1 !important;
  /* Prevent any blur effects */
  filter: none !important;
  -webkit-filter: none !important;
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
  /* DON'T force transforms on container - let Leaflet handle it */
}

.leaflet-pane,
.leaflet-tile-pane,
.leaflet-marker-pane,
.leaflet-tooltip-pane,
.leaflet-popup-pane,
.leaflet-shadow-pane,
.leaflet-overlay-pane {
  /* Ensure no blur is applied to any map panes */
  filter: none !important;
  -webkit-filter: none !important;
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
  /* Let Leaflet handle transforms naturally */
}

/* Specific fix for marker icons */
.leaflet-marker-icon {
  filter: none !important;
  -webkit-filter: none !important;
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
  image-rendering: -webkit-optimize-contrast !important;
  image-rendering: crisp-edges !important;
  transform: translateZ(0) !important;
  -webkit-transform: translateZ(0) !important;
}

/* Fix z-index hierarchy - let Leaflet handle transforms */
.leaflet-tile-pane { z-index: 200 !important; }
.leaflet-shadow-pane { z-index: 500 !important; }
.leaflet-overlay-pane { z-index: 400 !important; }
.leaflet-marker-pane { z-index: 600 !important; }
.leaflet-tooltip-pane { z-index: 650 !important; }
.leaflet-popup-pane { z-index: 700 !important; }

/* Improved tile rendering to prevent grey flashing */
.leaflet-tile {
  image-rendering: auto !important;
  /* Prevent tiles from disappearing during drag */
  opacity: 1 !important;
  transition: none !important;
  /* Ensure tiles load smoothly */
  background-color: transparent !important;
}

/* Prevent map from showing grey background during tile loading */
.leaflet-container {
  background-color: #f8f9fa !important; /* Light grey instead of pure grey */
  cursor: crosshair !important; /* Crosshair cursor to indicate location dropping */
  position: relative !important;
  z-index: 1 !important;
  touch-action: none !important; /* Allow Leaflet to handle all touch events */
  pointer-events: auto !important; /* Ensure mouse events work */
  user-select: none !important; /* Prevent text selection while dragging */
  /* Remove conflicting transforms that prevent tile movement */
  transform: none !important;
  -webkit-transform: none !important;
}

/* Improve tile layer performance */
.leaflet-tile-pane {
  /* Ensure smooth tile transitions */
  opacity: 1 !important;
}

/* Prevent tile fade effects that cause grey flashing */
.leaflet-tile-container {
  opacity: 1 !important;
  transition: none !important;
}

/* Ensure map controls are above map but below modals */
.leaflet-control {
  z-index: 800 !important;
}

@layer base {
  :root {
    --background: 0 0% 100%;
    --foreground: 0 0% 3.9%;

    --card: 0 0% 100%;
    --card-foreground: 0 0% 3.9%;

    --popover: 0 0% 100%;
    --popover-foreground: 0 0% 3.9%;

    --primary: 0 0% 9%;
    --primary-foreground: 0 0% 98%;

    --secondary: 0 0% 96.1%;
    --secondary-foreground: 0 0% 9%;

    --muted: 0 0% 96.1%;
    --muted-foreground: 0 0% 45.1%;

    --accent: 0 0% 96.1%;
    --accent-foreground: 0 0% 9%;

    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 0 0% 98%;

    --border: 0 0% 89.8%;
    --input: 0 0% 89.8%;
    --ring: 0 0% 3.9%;

    --radius: 0.5rem;

    /* Calendar Color Scheme */
    --calendar-primary-scarlet: 0 72% 50%; /* #dc2625 */
    --calendar-pale-slate: 230 7% 82%; /* #cfd0d5 */
    --calendar-blue-slate: 221 16% 35%; /* #4c5568 */
    --calendar-cool-steel: 205 20% 57%; /* #7b95a7 */
    --calendar-platinum: 214 33% 96%; /* #f1f4f8 */ --chart-1: 12 76% 61%; --chart-2: 173 58% 39%; --chart-3: 197 37% 24%; --chart-4: 43 74% 66%; --chart-5: 27 87% 67%;
  }

  /* MapLibre popup styling - remove default card appearance */
  .maplibregl-popup-content {
    @apply bg-transparent! shadow-none! p-0! rounded-none!;
  }
  .maplibregl-popup-tip {
    @apply hidden!;
  }

  .dark {
    --background: 0 0% 3.9%;
    --foreground: 0 0% 98%;

    --card: 0 0% 3.9%;
    --card-foreground: 0 0% 98%;

    --popover: 0 0% 3.9%;
    --popover-foreground: 0 0% 98%;

    --primary: 0 0% 98%;
    --primary-foreground: 0 0% 9%;

    --secondary: 0 0% 14.9%;
    --secondary-foreground: 0 0% 98%;

    --muted: 0 0% 14.9%;
    --muted-foreground: 0 0% 63.9%;

    --accent: 0 0% 14.9%;
    --accent-foreground: 0 0% 98%;

    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 0 0% 98%;

    --border: 0 0% 14.9%;
    --input: 0 0% 14.9%;
    --ring: 0 0% 83.1%;

    /* Calendar Color Scheme (dark mode) */
    --calendar-primary-scarlet: 0 72% 50%; /* #dc2625 */
    --calendar-pale-slate: 230 7% 82%; /* #cfd0d5 */
    --calendar-blue-slate: 221 16% 35%; /* #4c5568 */
    --calendar-cool-steel: 205 20% 57%; /* #7b95a7 */
    --calendar-platinum: 214 33% 96%; /* #f1f4f8 */ --chart-1: 220 70% 50%; --chart-2: 160 60% 45%; --chart-3: 30 80% 55%; --chart-4: 280 65% 60%; --chart-5: 340 75% 55%;
  }
  .maplibregl-popup-content {
    @apply bg-transparent! shadow-none! p-0! rounded-none!;
  }
  .maplibregl-popup-tip {
    @apply hidden!;
  }
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
  }

  /* Remove any default borders on main containers */
  main {
    border: none !important;
  }

  /* Ensure no pseudo-elements create bottom lines */
  main::after,
  main::before,
  body::after,
  body::before {
    border: none !important;
    box-shadow: none !important;
  }

  /* Smooth transitions for interactive elements */
  button, a {
    @apply transition-colors;
  }

  /* Better focus states */
  :focus-visible {
    @apply outline-none ring-2 ring-ring ring-offset-2 ring-offset-background;
  }
}

/* Leaflet map fixes for modal containment */
.leaflet-container {
  background: transparent;
  z-index: 1 !important;
}

/* Ensure Leaflet controls stay within modal bounds */
.leaflet-control-container {
  z-index: 10 !important;
  position: relative !important;
}

.leaflet-popup-pane {
  z-index: 700 !important;
}

.leaflet-tooltip-pane {
  z-index: 650 !important;
}

.leaflet-marker-pane {
  z-index: 600 !important;
}

/* Prevent map overflow in containers */
.leaflet-container .leaflet-control-zoom {
  border: none;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12);
}

/* Prevent blur effects on map elements */
.leaflet-marker-icon,
.leaflet-marker-shadow {
  filter: none !important;
  backdrop-filter: none !important;
}

/* Enhanced map interactions - CRITICAL for scrolling/panning */
.leaflet-container:active {
  cursor: grabbing !important; /* Grabbing cursor when dragging */
}

/* Crosshair cursor for better location dropping UX */
.leaflet-map-container .leaflet-container {
  cursor: crosshair !important;
}

/* Specific fix for our map container */
.leaflet-map-container {
  touch-action: none !important;
  pointer-events: auto !important;
  overflow: hidden !important;
  /* Ensure container doesn't have transform conflicts */
  transform: none !important;
}

/* Allow multi-touch gestures */
.leaflet-interactive {
  touch-action: none !important;
}

/* Ensure no overlapping elements block map interaction */
.leaflet-container * {
  pointer-events: auto !important;
}

/* Force enable map panes to receive events */
.leaflet-pane {
  pointer-events: auto !important;
}

/* Ensure map controls work */
.leaflet-control-container {
  pointer-events: auto !important;
}

.leaflet-control-container * {
  pointer-events: auto !important;
}

/* Enhanced administrative boundary visibility */
.admin-boundaries {
  filter: contrast(1.2) saturate(0.8);
  mix-blend-mode: multiply;
}

/* Myanmar focus mode styling */
.myanmar-focus .leaflet-tile-pane {
  filter: grayscale(0.3) brightness(0.9);
}

.myanmar-focus .leaflet-overlay-pane {
  position: relative;
}

/* Gray overlay for non-Myanmar areas */
.world-overlay {
  background-color: rgba(128, 128, 128, 0.3);
  mix-blend-mode: multiply;
}

/* Modal dialog z-index higher than Leaflet */
[data-radix-dialog-content] {
  z-index: 1000 !important;
}

/* Ensure modal overlay is above everything */
[data-radix-dialog-overlay] {
  z-index: 999 !important;
}

/* Ensure hover card content is fully opaque */
[data-radix-hover-card-content] {
  background-color: #f6f5f3 !important;
  opacity: 1 !important;
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
}

/* Ensure modal is properly centered and contained */
[data-radix-dialog-content] {
  position: fixed !important;
  left: 50% !important;
  top: 50% !important;
  transform: translate(-50%, -50%) !important;
  margin: 0 !important;
  width: calc(100vw - 2rem) !important;
  max-width: 100% !important;
}

/* Prevent horizontal overflow on small screens */
@media (max-width: 768px) {
  [data-radix-dialog-content] {
    width: calc(100vw - 1rem) !important;
    margin: 0.5rem !important;
    transform: translate(-50%, -50%) !important;
    left: 50% !important;
    top: 50% !important;
  }
}

/* Prevent body scroll when modal is open */
body:has([data-radix-dialog-content]) {
  overflow: hidden;
}

/* Skeleton Shimmer Animation */
@keyframes shimmer {
  0% {
    background-position: -200% 0;
  }
  100% {
    background-position: 200% 0;
  }
}

.skeleton-shimmer {
  background: linear-gradient(
    90deg,
    rgba(0, 0, 0, 0.04) 0%,
    rgba(0, 0, 0, 0.08) 50%,
    rgba(0, 0, 0, 0.04) 100%
  );
  background-size: 200% 100%;
  animation: shimmer 1.5s ease-in-out infinite;
}

/* Alternative blush-toned shimmer */
.skeleton-shimmer-blush {
  background: linear-gradient(
    90deg,
    rgba(255, 228, 225, 0.5) 0%,
    rgba(255, 228, 225, 0.8) 50%,
    rgba(255, 228, 225, 0.5) 100%
  );
  background-size: 200% 100%;
  animation: shimmer 1.5s ease-in-out infinite;
}

/* Soft fade-in animation for content */
@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(4px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.fade-in {
  animation: fadeIn 0.3s ease-out;
}

/* Slide up animation for dropdowns */
@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Line clamp utilities for text truncation */
.line-clamp-1 {
  overflow: hidden;
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-line-clamp: 1;
}

.line-clamp-2 {
  overflow: hidden;
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-line-clamp: 2;
}

/* Hide scrollbar tracks when not scrolling */
.scrollbar-thin {
  scrollbar-width: thin;
  scrollbar-color: rgba(0, 0, 0, 0.1) transparent;
}

.scrollbar-thin::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

.scrollbar-thin::-webkit-scrollbar-track {
  background: transparent;
  border: none;
}

.scrollbar-thin::-webkit-scrollbar-thumb {
  background-color: rgba(0, 0, 0, 0.1);
  border-radius: 4px;
  border: none;
}

.scrollbar-thin::-webkit-scrollbar-thumb:hover {
  background-color: rgba(0, 0, 0, 0.2);
}

/* Ensure no overflow container borders */
[class*="overflow-"] {
  border: none;
}

/* Remove any bottom borders on scroll containers */
.overflow-y-auto::-webkit-scrollbar-track {
  border-bottom: none !important;
}

/* React Day Picker Calendar Overrides */
.rdp {
  --rdp-cell-size: 48px;
  --rdp-accent-color: #000000;
  font-family: inherit;
}

/* Force proper grid layout for calendar */
.rdp-table {
  width: 100% !important;
  border-collapse: separate !important;
  border-spacing: 0 !important;
}

.rdp-head_row,
.rdp-row {
  display: grid !important;
  grid-template-columns: repeat(7, 1fr) !important;
  width: 100% !important;
  gap: 0 !important;
  margin: 0 !important;
}

.rdp-head_cell {
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  height: 32px !important;
  width: 100% !important;
  padding: 0 !important;
  margin: 0 !important;
  box-sizing: border-box !important;
  font-size: 13px !important;
  font-weight: 500 !important;
  color: #6b7280 !important;
  text-align: center !important;
}

.rdp-cell {
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  height: var(--rdp-cell-size) !important;
  width: 100% !important;
  padding: 0 !important;
  margin: 0 !important;
  box-sizing: border-box !important;
}

.rdp-day {
  width: 40px !important;
  height: 40px !important;
  border-radius: 9999px !important;
  border: 0 !important;
  font-size: 14px !important;
  cursor: pointer !important;
  background: transparent !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  transition: background-color 0.15s ease !important;
  color: inherit !important;
  margin: 0 auto !important;
}

.rdp-day:hover {
  background-color: #f3f4f6 !important;
}

.rdp-day_selected {
  background-color: #000000 !important;
  color: white !important;
}

.rdp-day_selected:hover {
  background-color: #000000 !important;
  color: white !important;
}

.rdp-day_today {
  background-color: #e5e7eb !important;
  font-weight: 600 !important;
}

.rdp-day_outside {
  color: #9ca3af !important;
  opacity: 0.5 !important;
}

.rdp-day_disabled {
  color: #d1d5db !important;
  opacity: 0.5 !important;
  cursor: not-allowed !important;
}

/* Ensure no default margins/padding interfere */
.rdp-tbody {
  border: 0 !important;
}

.rdp-head {
  border: 0 !important;
}

/* Fix spacing between rows */
.rdp-row {
  margin-top: 2px !important;
}

.rdp-row:first-child {
  margin-top: 0 !important;
}

.rdp-head_row {
  margin-bottom: 8px !important;
}

/* Ensure weekday abbreviations are centered */
.rdp-head_cell abbr[title] {
  text-decoration: none !important;
  cursor: default !important;
}

/* Additional alignment fixes for date picker */
.rdp-caption {
  display: none !important;
}

.rdp-nav {
  display: none !important;
}

/* Ensure consistent cell sizing */
.rdp-cell,
.rdp-head_cell {
  min-width: var(--rdp-cell-size) !important;
  max-width: var(--rdp-cell-size) !important;
}

/* Force center alignment for all calendar content */
.rdp th,
.rdp td {
  text-align: center !important;
  vertical-align: middle !important;
}

/* Ensure the calendar grid is properly sized */
.rdp-months {
  display: flex !important;
  justify-content: center !important;
}

.rdp-month {
  width: 100% !important;
}

/* Override any conflicting styles */
.rdp-button {
  margin: 0 auto !important;
}

/* Heatmap tooltip styling */
.heatmap-tooltip {
  background: rgba(255, 255, 255, 0.9) !important;
  border: 2px solid #f97316 !important;
  border-radius: 50% !important;
  padding: 4px 8px !important;
  font-weight: bold !important;
  color: #ea580c !important;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2) !important;
}

.heatmap-tooltip::before {
  display: none !important;
}

/* Location marker tooltip styling */
.location-tooltip {
  background: white !important;
  border: 1px solid #e5e7eb !important;
  border-radius: 8px !important;
  padding: 8px 12px !important;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15) !important;
}

.location-tooltip::before {
  border-top-color: white !important;
}

/* Leaflet popup styling */
.leaflet-popup-content-wrapper {
  border-radius: 12px !important;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15), 0 2px 8px rgba(0, 0, 0, 0.1) !important;
  padding: 0 !important;
  overflow: hidden !important;
}

.leaflet-popup-content {
  margin: 16px !important;
  line-height: 1.5 !important;
}

/* Location popup specific styles */
.location-popup .leaflet-popup-content-wrapper {
  background: white !important;
  border: 1px solid #f3f4f6 !important;
  border-radius: 16px !important;
  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25), 0 8px 16px -8px rgba(0, 0, 0, 0.1) !important;
}

.location-popup .leaflet-popup-content {
  margin: 0 !important;
  padding: 16px !important;
  user-select: text !important;
  -webkit-user-select: text !important;
  cursor: auto !important;
}

.location-popup .leaflet-popup-content * {
  user-select: text !important;
  -webkit-user-select: text !important;
}

.location-popup .leaflet-popup-tip {
  background: white !important;
  border: 1px solid #f3f4f6 !important;
  box-shadow: none !important;
}

/* Hide close button on popup */
.location-popup .leaflet-popup-close-button {
  display: none !important;
}

/* Location tooltip styles */
.location-tooltip {
  background: white !important;
  border: 1px solid #e2e8f0 !important;
  border-radius: 12px !important;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.12), 0 2px 6px rgba(0, 0, 0, 0.08) !important;
  padding: 12px !important;
  color: #1e293b !important;
  max-width: 320px !important;
  width: auto !important;
  white-space: normal !important;
}

.location-tooltip .leaflet-tooltip-content {
  white-space: normal !important;
  word-wrap: break-word !important;
  user-select: text !important;
  -webkit-user-select: text !important;
  cursor: auto !important;
}

.location-tooltip * {
  user-select: text !important;
  -webkit-user-select: text !important;
}

.location-tooltip::before {
  border-top-color: white !important;
}

/* Clean marker styles */
.leaflet-marker-pane {
  z-index: 600 !important;
}

.leaflet-marker-icon {
  opacity: 1 !important;
  visibility: visible !important;
}

/* Force left alignment for Reported by column in activities table */
table td:has(div:contains("AA-AAA")) {
  text-align: left !important;
}

/* Force left alignment for all Reported by column content */
.activities-table td:nth-child(4) {
  text-align: left !important;
}

/* Debug overlay for test marker - temporarily disabled */
.leaflet-container.debug-mode::after {
  content: "ðŸŽ¯ Looking for red pin at center" !important;
  position: absolute !important;
  top: 10px !important;
  right: 10px !important;
  background: rgba(220, 38, 38, 0.9) !important;
  color: white !important;
  padding: 8px !important;
  border-radius: 4px !important;
  font-size: 12px !important;
  z-index: 10000 !important;
  pointer-events: none !important;
}

/* Aid Effectiveness gradient animation */
@keyframes gradientShift {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

/* ===== NProgress Loading Bar Styles ===== */
#nprogress {
  pointer-events: none;
}

#nprogress .bar {
  background: #64748b; /* Slate-500 */
  position: fixed;
  z-index: 9999;
  top: 0;
  left: 0;
  width: 100%;
  height: 3px;
}

#nprogress .peg {
  display: block;
  position: absolute;
  right: 0px;
  width: 100px;
  height: 100%;
  opacity: 1;
  transform: rotate(3deg) translate(0px, -4px);
}

/* Hide the spinner (configured in JS, but this is a fallback) */
#nprogress .spinner {
  display: none;
}

#nprogress .spinner-icon {
  display: none;
}

/* ===== Cross-Browser & High-DPI Display Fixes ===== */

/* Firefox-specific fixes for high-DPI displays */
@supports (-moz-appearance: none) {
  /* Prevent flex items from overflowing their containers */
  .flex > * {
    min-width: 0;
  }

  /* Fix grid gap calculations in Firefox */
  .grid {
    grid-gap: inherit;
  }

  /* Ensure text truncation works consistently */
  .whitespace-nowrap {
    max-width: 100%;
  }
}

/* Universal high-DPI fixes */
@media (-webkit-min-device-pixel-ratio: 1.5), (min-resolution: 144dpi) {
  /* Improve text rendering on high-DPI displays */
  body {
    text-rendering: optimizeLegibility;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  /* Prevent subpixel rendering issues */
  .text-xs, .text-sm {
    text-rendering: geometricPrecision;
  }
}

/* Prevent flex children from overflowing (cross-browser) */
.flex-item-min-w-0 > * {
  min-width: 0;
}

/* Ensure truncate class works consistently across browsers */
.truncate {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  max-width: 100%;
}

/* Fix for grid items that might overflow */
.grid > * {
  min-width: 0;
  overflow: hidden;
}

/* Responsive text that won't overflow containers */
.text-responsive {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  max-width: 100%;
}

/* Firefox line-clamp compatibility */
.line-clamp-1,
.line-clamp-2,
.line-clamp-3 {
  display: -webkit-box;
  -webkit-box-orient: vertical;
  overflow: hidden;
  word-break: break-word;
}

.line-clamp-1 {
  -webkit-line-clamp: 1;
  line-clamp: 1;
}

.line-clamp-2 {
  -webkit-line-clamp: 2;
  line-clamp: 2;
}

.line-clamp-3 {
  -webkit-line-clamp: 3;
  line-clamp: 3;
}

/* ===== Accessibility & Device-Specific Fixes ===== */

/* Reduced Motion - Respect user preferences */
@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* Safe Area Insets for Notched Devices (iPhone X+, etc.) */
.safe-area-inset {
  padding-left: env(safe-area-inset-left);
  padding-right: env(safe-area-inset-right);
  padding-bottom: env(safe-area-inset-bottom);
}

/* Main layout wrapper with safe areas */
.main-layout {
  min-height: 100dvh; /* Dynamic viewport height */
  padding-bottom: env(safe-area-inset-bottom, 0);
}

/* Mobile Viewport Height Fix - 100vh includes address bar on mobile */
.min-h-screen-safe {
  min-height: 100vh;
  min-height: 100dvh;
}

.h-screen-safe {
  height: 100vh;
  height: 100dvh;
}

/* Gap Fallback for Older Safari (< 14.1) */
@supports not (gap: 1rem) {
  .flex-gap-fallback > * + * {
    margin-left: 0.5rem;
  }
  .flex-gap-fallback-y > * + * {
    margin-top: 0.5rem;
  }
}